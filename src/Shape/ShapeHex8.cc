
#include "ShapeHex8.h"

namespace voom {  
  void ShapeHex8::compute(const CoordinateArray & s) {

    _functions[0] = 0.125*(1-s(0))*(1-s(1))*(1+s(2));
    _functions[1] = 0.125*(1+s(0))*(1-s(1))*(1+s(2));
    _functions[2] = 0.125*(1+s(0))*(1-s(1))*(1-s(2));
    _functions[3] = 0.125*(1-s(0))*(1-s(1))*(1-s(2));
    _functions[4] = 0.125*(1-s(0))*(1+s(1))*(1+s(2));
    _functions[5] = 0.125*(1+s(0))*(1+s(1))*(1+s(2));  
    _functions[6] = 0.125*(1+s(0))*(1+s(1))*(1-s(2));
    _functions[7] = 0.125*(1-s(0))*(1+s(1))*(1-s(2));
    
    _derivatives[0] =  -0.125*(1-s(1))*(1+s(2)), -0.125*(1-s(0))*(1+s(2)),  0.125*(1-s(0))*(1-s(1));
    _derivatives[1] =   0.125*(1-s(1))*(1+s(2)), -0.125*(1+s(0))*(1+s(2)),  0.125*(1+s(0))*(1-s(1));
    _derivatives[2] =   0.125*(1-s(1))*(1-s(2)), -0.125*(1+s(0))*(1-s(2)), -0.125*(1+s(0))*(1-s(1));
    _derivatives[3] =  -0.125*(1-s(1))*(1-s(2)), -0.125*(1-s(0))*(1-s(2)), -0.125*(1-s(0))*(1-s(1));
    _derivatives[4] =  -0.125*(1+s(1))*(1+s(2)),  0.125*(1-s(0))*(1+s(2)),  0.125*(1-s(0))*(1+s(1));
    _derivatives[5] =   0.125*(1+s(1))*(1+s(2)),  0.125*(1+s(0))*(1+s(2)),  0.125*(1+s(0))*(1+s(1));   
    _derivatives[6] =   0.125*(1+s(1))*(1-s(2)),  0.125*(1+s(0))*(1-s(2)), -0.125*(1+s(0))*(1+s(1));
    _derivatives[7] =  -0.125*(1+s(1))*(1-s(2)),  0.125*(1-s(0))*(1-s(2)), -0.125*(1-s(0))*(1+s(1)); 

  }

};
