project(lbfgsb)
enable_language(Fortran)
IF(WIN32)
	IF("${CMAKE_Fortran_COMPILER_ID}" STREQUAL "Intel")
		MESSAGE("Intel Fortran Compiler detected on Windows platform.")
		MESSAGE("Changing compile flags to make floating point operations to be precise...")
		MESSAGE("CMAKE_Fortran_FLAGS was ${CMAKE_Fortran_FLAGS}")
		SET(CMAKE_Fortran_FLAGS "${CMAKE_Fortran_FLAGS} /fp:precise" CACHE STRING "Flags used by the compiler." FORCE)
		MESSAGE("CMAKE_Fortran_FLAGS is now ${CMAKE_Fortran_FLAGS}")
	ELSE()
		MESSAGE(Please check floating point precision compile options. \n Aggressive optimization may lead to Lbfgs solver to get stuck in infinite loop)
		set (MINGW_GFORTRAN "C:/Software/mingw-w64/mingw64/bin/gfortran.exe" CACHE FILEPATH "Please provide full path to mingw-gfortran.exe")
	ENDIF()
ENDIF(WIN32)
if(VOOM_USE_OPENMP)
	add_library(lbfgsb lbfgsb-routines-parallel.f)
else()
	add_library(lbfgsb lbfgsb-routines.f)
endif()